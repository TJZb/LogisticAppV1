# โครงสร้างไฟล์และโฟล์เดอร์ของระบบ LogisticApp V1 (Updated)

## การจัดระเบียบไฟล์สำหรับทีมงาน

### 📁 โครงสร้างหลัก

```
LogisticAppV1/
├── config/                     # การตั้งค่าระบบ
│   └── config.php              # การตั้งค่าหลักของระบบ
├── includes/                   # ไฟล์ที่ใช้งานร่วมกัน
│   ├── functions.php           # ฟังก์ชันทั่วไป
│   ├── auth.php               # การจัดการการรับรองตัวตน
│   └── file_upload.php        # การจัดการการอัปโหลดไฟล์
├── service/                    # บริการและการเชื่อมต่อฐานข้อมูล
│   └── connect.php            # การเชื่อมต่อฐานข้อมูลและฟังก์ชันพื้นฐาน
├── database/                   # ไฟล์ฐานข้อมูล
│   ├── database_config.php    # คลาสจัดการฐานข้อมูล
│   ├── complete_database_setup.sql  # ไฟล์ตั้งค่าฐานข้อมูลหลัก
│   └── README.md              # เอกสารการใช้งานฐานข้อมูล
├── AdminPage/                  # หน้าสำหรับผู้ดูแลระบบ
│   └── user_manage.php        # จัดการผู้ใช้งาน
├── ManagerPage/                # หน้าสำหรับผู้จัดการ
│   ├── index.php              # จัดการรถและรถพ่วง
│   ├── report.php             # รายงานการเติมน้ำมัน
│   ├── orderlist.php          # รายการคำสั่งเติมน้ำมัน
│   ├── employee.php           # จัดการพนักงาน
│   └── get_mileage_constraint.php # ตรวจสอบระยะทาง
├── EmployeePage/               # หน้าสำหรับพนักงาน
│   ├── index.php              # หน้าแรกพนักงาน
│   ├── Addfeal_form.php       # ฟอร์มเติมน้ำมัน
│   ├── fuel_history.php       # ประวัติการเติมน้ำมัน
│   └── profile_setting.php   # ตั้งค่าโปรไฟล์
├── container/                  # ส่วนประกอบ UI
│   ├── header.php             # Header หน้าเว็บ
│   └── footer.php             # Footer หน้าเว็บ
├── asset/                      # ไฟล์ CSS และทรัพยากร
│   └── css/
│       └── app-theme.css      # CSS หลักของระบบ
├── uploads/                    # ไฟล์ที่อัปโหลด
├── index.php                   # หน้าแรกของระบบ
├── login.php                  # หน้าเข้าสู่ระบบ
└── logout.php                 # ออกจากระบบ
```

### ✅ การปรับปรุงล่าสุด
- ✅ ลบไฟล์ทดสอบ: `test_session.php`, `test_paths.php`
- ✅ ลบไฟล์ซ้ำ: `ManagerPage/vehicle_report.php` (ฟังก์ชันซ้ำกับ report.php)
- ✅ แก้ไขระบบจัดการรถพ่วง: ใช้ตาราง `vehicles` แทน `trailers` ที่ไม่มีอยู่
- ✅ ปรับปรุงชื่อฐานข้อมูลให้ตรงกับ schema: ใช้ตัวพิมพ์เล็กทั้งหมด

### 🎯 หน้าที่ของแต่ละไฟล์

#### **config/config.php**
- การตั้งค่าระบบทั้งหมด (ฐานข้อมูล, การอัปโหลด, เวลา)
- ค่าคงที่ที่ใช้ทั่วทั้งระบบ
- การตั้งค่าความปลอดภัย

#### **includes/functions.php**
- ฟังก์ชันทั่วไปที่ใช้ร่วมกัน
- การ sanitize ข้อมูล
- การจัดการวันที่
- การคำนวณระยะทาง
- การแสดงข้อความแจ้งเตือน

#### **includes/auth.php**
- การจัดการการเข้าสู่ระบบ/ออกจากระบบ
- การตรวจสอบสิทธิ์และเซสชัน
- การเปลี่ยนรหัสผ่าน
- การบันทึกกิจกรรมผู้ใช้

#### **service/connect.php**
- การเชื่อมต่อฐานข้อมูล SQL Server
- ฟังก์ชัน getCar() และ insertWithId()
- การจัดการข้อผิดพลาดฐานข้อมูล

#### **database/database_config.php**
- คลาส VehicleManager
- การจัดการข้อมูลรถยนต์
- ฟังก์ชัน CRUD ครบชุด

### 📋 หลักการใช้งาน

#### **1. การเรียกใช้ไฟล์**
```php
// เรียกใช้การตั้งค่า
require_once 'config/config.php';

// เรียกใช้ฟังก์ชันทั่วไป
require_once 'includes/functions.php';

// เรียกใช้การรับรองตัวตน
require_once 'includes/auth.php';

// เรียกใช้การเชื่อมต่อฐานข้อมูล
require_once 'service/connect.php';
```

#### **2. การตรวจสอบสิทธิ์**
```php
// ตรวจสอบการเข้าสู่ระบบ
require_login();

// ตรวจสอบสิทธิ์ตามบทบาท
require_role(['manager', 'admin']);
```

### 🔒 การรักษาความปลอดภัย

1. **การ Sanitize ข้อมูล**: ใช้ `sanitize_input()` กับข้อมูลจากผู้ใช้
2. **การตรวจสอบเซสชัน**: มี timeout อัตโนมัติ
3. **การบันทึกกิจกรรม**: บันทึกการเข้าใช้และข้อผิดพลาด
4. **การจัดการไฟล์**: ใช้การอัปโหลดไฟล์แบบปลอดภัยในฟอร์มการเติมน้ำมัน

### 📈 การพัฒนาเพิ่มเติม

#### **การเพิ่มฟีเจอร์ใหม่**
1. สร้างไฟล์ในโฟล์เดอร์ที่เหมาะสม
2. เรียกใช้ไฟล์ที่จำเป็นจาก includes/
3. ใช้ฟังก์ชันที่มีอยู่แล้วแทนการเขียนใหม่

#### **การแก้ไขบัก**
1. ตรวจสอบ logs/ สำหรับข้อผิดพลาด
2. ใช้ฟังก์ชัน `log_activity()` เพื่อติดตาม
3. แก้ไขในไฟล์ที่เหมาะสม

### 🚀 คำแนะนำสำหรับทีม

1. **แก้ไขไฟล์เดียวต่อครั้ง**: หลีกเลี่ยงการแก้ไขหลายไฟล์พร้อมกัน
2. **ใช้ฟังก์ชันที่มีอยู่**: ตรวจสอบ includes/ ก่อนเขียนใหม่
3. **ตั้งค่าใน config.php**: ไม่ต้องกระจายการตั้งค่าในหลายไฟล์
4. **บันทึกกิจกรรม**: ใช้ `log_activity()` สำหรับการติดตาม
5. **ตรวจสอบสิทธิ์**: ใช้ฟังก์ชันจาก auth.php ทุกหน้า

### 📝 รายการ TODO

- [ ] เพิ่มระบบ API สำหรับ mobile app
- [ ] ปรับปรุงระบบ notification
- [ ] เพิ่มระบบ backup อัตโนมัติ
- [ ] ปรับปรุง UI/UX
- [ ] เพิ่มระบบ cache

---
**หมายเหตุ**: ไฟล์นี้จะต้องอัปเดตเมื่อมีการเปลี่ยนแปลงโครงสร้าง
